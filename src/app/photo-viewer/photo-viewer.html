<!-- photo-page.component.html -->
<div class="min-h-screen bg-zinc-950 text-zinc-100">
  <div class="mx-auto max-w-6xl px-4 py-8">
    <app-seach-field (photoChange)="onPhotosChange($event)"></app-seach-field>

    <mat-drawer-container
      class="mt-6 block h-[calc(100vh-220px)] min-h-[520px] w-full overflow-hidden rounded-2xl border border-zinc-800 bg-zinc-950"
      autosize
    >
      <mat-drawer
        #drawer
        position="end"
        mode="side"
        class="drawer-solid w-[380px] bg-zinc-950 text-zinc-100"
      >
        <div class="h-full">
          <div class="flex items-start justify-between gap-3 border-b border-zinc-800 p-4">
            <div class="min-w-0">
              @if (selected()) {
                <div class="truncate text-sm font-medium">
                  {{ selected()!.title || '(sans titre)' }}
                </div>
                <div class="mt-1 text-xs text-zinc-400">
                  <span class="text-zinc-500">Auteur :</span> {{ selected()!.owner }}
                  <span class="mx-2 text-zinc-600">â€¢</span>
                  <span class="text-zinc-500">ID :</span> {{ selected()!.id }}
                </div>
              } @else {
                <div class="text-sm text-zinc-400">Clique une image</div>
              }
            </div>

            <button mat-button (click)="close()" class="shrink-0">Fermer</button>
          </div>

          <div class="p-4">
            @if (selected()) {
              <div class="overflow-hidden rounded-2xl border border-zinc-800 bg-zinc-900">
                <img
                  [src]="imgUrl(selected()!)"
                  [alt]="selected()!.title"
                  class="max-h-[70vh] w-full object-contain"
                />
              </div>
            }
          </div>
        </div>
      </mat-drawer>

      <mat-drawer-content class="bg-zinc-950">
        <div class="h-full overflow-auto p-4">
          <div class="grid min-w-0 grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5">
            @for (p of photos(); track p.id) {
              <button
                (click)="open(p)"
                class="group overflow-hidden rounded-xl border border-zinc-800 bg-zinc-900 text-left hover:border-zinc-700"
              >
                <div class="aspect-[4/3] w-full overflow-hidden bg-zinc-950">
                  <img
                    [src]="imgUrl(p)"
                    [alt]="p.title"
                    class="h-full w-full object-cover transition group-hover:scale-[1.02]"
                    loading="lazy"
                  />
                </div>
                <div class="px-3 py-2">
                  <div class="truncate text-xs text-zinc-200">{{ p.title || '(sans titre)' }}</div>
                </div>
              </button>
            }
          </div>
        </div>
      </mat-drawer-content>
    </mat-drawer-container>
  </div>
</div>
